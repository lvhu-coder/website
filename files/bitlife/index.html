<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>BitLife Offline</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="webgl-content">
    <div id="gameContainer" style="width: 100%; height: 100%;"></div>
  </div>

<script src="TemplateData/UnityProgress.js"></script>
<script src="Build/UnityLoader.js"></script>
<script>
async function runOfflineUnity() {
    const buildJSON = await (await fetch('Build.json')).json();

    // Convert Build files to Blob URLs
    const Module = {
        TOTAL_MEMORY: 268435456,
        dataUrl: URL.createObjectURL(new Blob([Uint8Array.from(atob(buildJSON['BitLife.data.unityweb']), c=>c.charCodeAt(0))], {type:'application/octet-stream'})),
        codeUrl: 'Build/BitLife.json', // normal JSON file on disk
        asmUrl: URL.createObjectURL(new Blob([Uint8Array.from(atob(buildJSON['BitLife.wasm.code.unityweb']), c=>c.charCodeAt(0))], {type:'application/octet-stream'})),
        memUrl: URL.createObjectURL(new Blob([Uint8Array.from(atob(buildJSON['BitLife.wasm.framework.unityweb']), c=>c.charCodeAt(0))], {type:'application/octet-stream'})),
        onProgress: UnityProgress
    };

    UnityLoader.instantiate("gameContainer", Module.codeUrl, {onProgress: UnityProgress, Module});
}

runOfflineUnity();
</script>
</body>
</html>
